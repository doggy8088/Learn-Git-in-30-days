# Day 16: Using git reflog to Track Change History

Have you ever accidentally deleted a branch or reset to the wrong commit? Git's reflog feature can help you recover from these situations. It's like a safety net that records almost every change you make to your repository.

## Understanding git reflog

`git reflog` (reference log) is a mechanism that records when the tips of branches and other references were updated in the local repository. It's particularly useful for:

* Finding commits that are no longer reachable from any branch
* Recovering from mistaken resets or rebases
* Understanding what you did in your repository

## Basic Usage

To view the reflog:

```
git reflog
```

This shows a list of recent actions in reverse chronological order. Each entry shows:
* The commit hash
* The reference (usually HEAD)
* The action that was performed
* The commit message

## Reflog Format

The output looks like:

```
a1b2c3d HEAD@{0}: commit: Add new feature
e4f5g6h HEAD@{1}: checkout: moving from master to feature-branch
i7j8k9l HEAD@{2}: reset: moving to HEAD~1
```

The `HEAD@{n}` notation refers to the nth prior value of HEAD.

## Viewing Detailed Reflog

For more detailed information:

```
git reflog show --all
```

To see the reflog for a specific branch:

```
git reflog show branch-name
```

## Using Reflog to Recover Commits

If you accidentally reset or lost commits, you can recover them using reflog:

```
# Find the commit you want to recover
git reflog

# Reset to that commit
git reset --hard HEAD@{2}
```

Or use the commit hash directly:

```
git reset --hard a1b2c3d
```

## Recovering Deleted Branches

If you deleted a branch by mistake:

```
# Find the commit where the branch was deleted
git reflog

# Recreate the branch
git branch branch-name HEAD@{3}
# or
git branch branch-name <commit-hash>
```

## Reflog Expiration

By default, reflog entries expire after 90 days for reachable commits and 30 days for unreachable commits. You can configure this:

```
git config gc.reflogExpire "90 days"
git config gc.reflogExpireUnreachable "30 days"
```

## Cleaning Up Reflog

To manually clean up reflog entries:

```
# Remove old reflog entries
git reflog expire --expire=now --all

# Run garbage collection
git gc --prune=now
```

## Limitations of Reflog

Important points to remember:

* Reflog is local only - it's not shared with others
* Reflog tracks changes to your repository, not files
* It can help you recover commits, but not uncommitted changes

## Practical Examples

### Example 1: Undoing a Hard Reset

```
# You accidentally reset
git reset --hard HEAD~3

# Find the old position
git reflog

# Restore to the old position
git reset --hard HEAD@{1}
```

### Example 2: Recovering After a Mistaken Rebase

```
# After a problematic rebase
git reflog

# Find the commit before the rebase (usually labeled "rebase finished")
git reset --hard HEAD@{5}
```

## Today's Summary

`git reflog` is a powerful safety feature that can save you from many Git mistakes. It's especially valuable when you need to recover from operations like reset, rebase, or branch deletion. While it's not a substitute for regular backups, it's an invaluable tool for local recovery.

Let me reorganize the Git commands and parameters learned today:

* git reflog
* git reflog show
* git reflog show --all
* git reset --hard HEAD@{n}
* git branch branch-name HEAD@{n}
* git reflog expire
* git gc

---

* [Back to Table of Contents](README.md)
* [Previous Day: Tags - Marking Important Events in Version Control](15.md)
* [Next Day: Basic Concepts and Usage of Merging](17.md)

---
